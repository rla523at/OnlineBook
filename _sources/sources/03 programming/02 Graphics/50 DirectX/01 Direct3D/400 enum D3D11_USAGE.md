# enum D3D11_USAGE 
D3D11_USAGE enum은 리소스의 사용 방법을 정의하는 열거형이다.

정의는 다음과 같다.
```cpp
typedef 
enum D3D11_USAGE
    {
        D3D11_USAGE_DEFAULT    = 0,
        D3D11_USAGE_IMMUTABLE  = 1,
        D3D11_USAGE_DYNAMIC    = 2,
        D3D11_USAGE_STAGING    = 3
    } 	D3D11_USAGE;
```
각 enum의 의미는 다음과 같다.

* D3D11_USAGE_DEFAULT
  * 리소스가 GPU에서만 접근 가능하며, 일반적인 용도로 사용된다.
* D3D11_USAGE_IMMUTABLE
  * 리소스가 생성된 후 변경할 수 없으며, 초기화 시 데이터가 설정된다.
* D3D11_USAGE_DYNAMIC
  * 리소스가 CPU에서 자주 갱신될 수 있으며, 주로 매 프레임마다 업데이트되는 데이터에 사용된다.
* D3D11_USAGE_STAGING
  * 리소스가 CPU와 GPU 간의 데이터 전송을 위해 사용되며, 읽기와 쓰기 모두 가능하다.

## D3D11_USAGE_DYNAMIC
`D3D11_USAGE_DYNAMIC`은 CPU가 자주 업데이트해야 하고 GPU가 자주 읽어야 하는 데이터를 효율적으로 처리하기 위해 설계되었다. 이 사용 방법은 CPU에서 데이터를 자주 변경할 수 있도록 최적화되어 있으며, GPU가 이러한 데이터를 빠르게 읽을 수 있도록 한다.

주요 특징 및 용도:

1. CPU가 자주 업데이트하는 데이터: `D3D11_USAGE_DYNAMIC`은 CPU가 자주 업데이트해야 하는 데이터에 적합하다. 예를 들어, 매 프레임마다 변하는 정점 데이터, 애니메이션 데이터, 또는 동적으로 생성되는 텍스처 데이터를 처리할 때 사용된다. 이러한 데이터는 렌더링 과정에서 실시간으로 변경될 필요가 있다.

2. 빠른 데이터 전송: 이 사용 방법을 사용하면 CPU가 데이터를 빠르게 업데이트하고, GPU가 이를 즉시 사용할 수 있다. 이는 중간 복사 단계 없이 데이터가 직접 GPU에 전달될 수 있어 레이턴시를 줄인다.

3. 바인딩 플래그: `D3D11_USAGE_DYNAMIC` 리소스는 GPU에 바인딩될 수 있다. 예를 들어, 정점 버퍼, 인덱스 버퍼, 상수 버퍼, 또는 셰이더 리소스 뷰로 사용할 수 있다. 이는 GPU가 업데이트된 데이터를 직접 접근하여 처리할 수 있도록 한다.

4. CPU 접근 권한: `D3D11_USAGE_DYNAMIC` 리소스는 주로 `D3D11_MAP_WRITE_DISCARD` 또는 `D3D11_MAP_WRITE_NO_OVERWRITE`를 통해 CPU가 접근할 수 있다. `D3D11_MAP_WRITE_DISCARD`를 사용하면 기존 데이터를 무효화하고 새로운 데이터를 쓰게 되며, `D3D11_MAP_WRITE_NO_OVERWRITE`를 사용하면 기존 데이터를 유지한 채 새로운 데이터를 추가할 수 있다.

5. 성능 최적화: 이 사용 방법은 CPU 쓰기 성능과 GPU 읽기 성능을 모두 최적화한다. CPU가 데이터를 빠르게 쓸 수 있도록 메모리 접근이 최적화되어 있으며, GPU가 이러한 데이터를 효율적으로 읽을 수 있도록 설계되어 있다.

적절한 사용 사례:

- 자주 변경되는 정점 데이터: 매 프레임마다 변하는 정점 데이터를 업데이트하는 경우, 예를 들어 애니메이션 캐릭터의 뼈대 데이터나 동적 물체의 위치 데이터.
- 상수 버퍼 업데이트: 렌더링 호출마다 변경되는 상수 데이터를 GPU에 전달하는 경우. 예를 들어, 변환 행렬, 조명 정보 등의 상수 데이터.
- 동적 텍스처: 실시간으로 텍스처 데이터를 업데이트해야 하는 경우, 예를 들어 비디오 스트리밍이나 실시간 렌더링 애플리케이션.

결론적으로, `D3D11_USAGE_DYNAMIC`은 자주 업데이트되어야 하는 데이터를 실시간으로 처리하기에 최적화된 사용 방법으로, CPU와 GPU 간의 효율적인 데이터 전송을 보장한다. 이를 통해 렌더링 성능을 향상시키고, 애플리케이션이 실시간으로 데이터를 업데이트할 수 있도록 한다. 특히 매 프레임마다 데이터가 변경되는 경우에 매우 유용하다.

## D3D11_USAGE_STAGING 
`D3D11_USAGE_STAGING`은 주로 GPU와 CPU 간의 데이터 전송을 목적으로 하며, 리소스를 GPU에 바인딩하지 않고도 데이터의 읽기와 쓰기가 가능하게 한다. 

`D3D11_USAGE_STAGING`을 설정한 리소스는 주로 데이터의 전송을 위해 사용되며, GPU가 직접 접근하지 않는 데이터의 임시 저장소 역할을 한다.

주요 특징 및 용도:

1. CPU와 GPU 간 데이터 전송: `D3D11_USAGE_STAGING`은 CPU와 GPU 간의 데이터 전송을 효율적으로 수행할 수 있도록 설계되었다. 이 사용 방법을 설정하면 CPU가 GPU의 메모리 리소스에 접근하여 데이터를 읽고 쓸 수 있다. 예를 들어, GPU에서 연산된 결과를 CPU로 읽어오거나, CPU에서 데이터를 준비하여 GPU로 전송하는 경우에 사용된다.

2. 데이터 복사 작업: `D3D11_USAGE_STAGING` 리소스는 주로 데이터 복사 작업에 사용된다. GPU에서 CPU로 데이터를 복사하거나, CPU에서 GPU로 데이터를 복사할 때 중간 버퍼 역할을 한다. 이는 GPU 리소스 간의 데이터 전송을 간접적으로 수행할 때도 유용하다.

3. 바인딩 플래그 없음: `D3D11_USAGE_STAGING` 리소스는 GPU에 바인딩되지 않으며, `BindFlags`를 0으로 설정해야 한다. 이는 이러한 리소스가 렌더 타겟이나 셰이더 리소스 뷰와 같은 용도로 사용되지 않음을 의미한다.

4. CPU 접근 권한: `D3D11_USAGE_STAGING` 리소스는 CPU에서 `D3D11_MAP_READ`와 `D3D11_MAP_WRITE` 접근 권한을 통해 데이터를 읽고 쓸 수 있다. 이는 CPU가 GPU 메모리에 있는 데이터를 효율적으로 조작할 수 있게 한다.

5. 성능 최적화: `D3D11_USAGE_STAGING` 리소스는 CPU 접근 성능에 최적화되어 있다. 이 사용 방법을 통해 CPU가 데이터를 빠르게 읽고 쓸 수 있으며, GPU는 이러한 데이터를 사용할 다른 리소스로 복사하여 처리할 수 있다.

적절한 사용 사례:

* GPU 결과를 CPU로 읽어오기: 예를 들어, 렌더 타겟에서 렌더링된 이미지를 CPU로 가져와 후속 처리(이미지 저장, 분석 등)를 수행하는 경우.
* 간접 데이터 전송: CPU에서 데이터를 스테이징 버퍼로 쓰고, 이 데이터를 GPU가 사용하는 다른 리소스로 복사해야 하는 경우. 이는 대량의 데이터를 안전하게 전송할 때 유용하다.

결론적으로, `D3D11_USAGE_STAGING`은 CPU와 GPU 간의 데이터 전송 및 복사 작업에 최적화된 사용 방법으로, 대량의 데이터를 안정적으로 전송하거나 CPU와 GPU 간의 상호 작용이 필요한 상황에서 유용하다. 이를 통해 효율적인 데이터 전송을 보장하면서도 데이터의 무결성을 유지할 수 있다.